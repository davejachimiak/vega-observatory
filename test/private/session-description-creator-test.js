// Generated by CoffeeScript 1.7.1
(function() {
  var SessionDescriptionCreator, chai, expect, sinon, sinonChai;

  chai = require('chai');

  sinon = require('sinon');

  sinonChai = require('sinon-chai');

  expect = chai.expect;

  chai.use(sinonChai);

  SessionDescriptionCreator = require('../../private/session-description-creator.js');

  describe('SessionDescriptionCreator', function() {
    beforeEach(function() {
      this.observatory = new Object;
      this.peerId = 'an peer id';
      this.peerConnection = {
        createOffer: function() {},
        createAnswer: function() {},
        setLocalDescription: function() {}
      };
      this.creator = new SessionDescriptionCreator(this.observatory, this.peerId, this.peerConnection);
      return this.failureCallback = this.creator.failureCallback;
    });
    afterEach(function() {
      return sinon.collection.restore();
    });
    describe('main public behavior', function() {
      beforeEach(function() {
        return this.stubSuccessCallback = (function(_this) {
          return function(arg) {
            return sinon.collection.stub(_this.creator, 'successCallback').withArgs(arg).returns(_this.successCallback = new Object);
          };
        })(this);
      });
      describe('#forOffer', function() {
        return it('creates an offer on the peer connection', function() {
          var createOffer;
          this.stubSuccessCallback(this.creator.sendOffer);
          createOffer = sinon.collection.stub(this.peerConnection, 'createOffer');
          this.creator.forOffer();
          return expect(createOffer).to.have.been.calledWith(this.successCallback, this.failureCallback);
        });
      });
      return describe('#forAnswer', function() {
        return it('creates an answer on the peer connection', function() {
          var createAnswer;
          this.stubSuccessCallback(this.creator.sendAnswer);
          createAnswer = sinon.collection.stub(this.peerConnection, 'createAnswer');
          this.creator.forAnswer();
          return expect(createAnswer).to.have.been.calledWith(this.successCallback, this.failureCallback);
        });
      });
    });
    return describe('successCallback', function() {
      return it('returns a callback that sets a local description with proper args', function() {
        var description, onLocalDescriptionSuccess, setLocalDescription;
        onLocalDescriptionSuccess = function() {};
        description = 'description';
        setLocalDescription = sinon.collection.stub(this.peerConnection, 'setLocalDescription');
        this.creator.successCallback(onLocalDescriptionSuccess)(description);
        return expect(setLocalDescription).to.have.been.calledWith(description, onLocalDescriptionSuccess, this.failureCallback);
      });
    });
  });

}).call(this);
