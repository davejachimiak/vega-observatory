// Generated by CoffeeScript 1.7.1
(function() {
  var PeerConnectionFactory;

  PeerConnectionFactory = (function() {
    function PeerConnectionFactory() {}

    PeerConnectionFactory.create = function(observatory, peer, config, pcConstructor) {
      var localStream, peerConnection, peerId;
      if (pcConstructor == null) {
        pcConstructor = RTCPeerConnection;
      }
      peerConnection = new pcConstructor(config);
      localStream = observatory.localStream;
      peerId = peer.peerId;
      peerConnection.addStream(localStream);
      peerConnection.onicecandidate = function(event) {
        var candidate;
        if (candidate = event.candidate) {
          return observatory.sendCandidate(candidate, peerId);
        }
      };
      peerConnection.onaddstream = function(event) {
        return observatory.addStream(peerId, event.stream);
      };
      return peerConnection;
    };

    return PeerConnectionFactory;

  })();

  module.exports = PeerConnectionFactory;

}).call(this);
